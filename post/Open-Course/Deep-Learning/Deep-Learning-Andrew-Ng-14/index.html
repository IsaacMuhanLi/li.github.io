<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/tag.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/tag.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/tag.png">
  <link rel="mask-icon" href="/images/tag.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Sans SC:300,300italic,400,400italic,700,700italic|Encode Sans:300,300italic,400,400italic,700,700italic|M PLUS 1p:300,300italic,400,400italic,700,700italic|Mulish:300,300italic,400,400italic,700,700italic|Oxygen Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"muhan.li","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":"flat"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Deep Learning Specialization, Course ESequence Models by deeplearning.ai, Andrew Ng, Coursera Week 1: Recurrent Neural Networks  Learn about recurrent neural networks. This type of model has been prov">
<meta property="og:type" content="article">
<meta property="og:title" content="Deep Learning (14) · Recurrent Neural Networks">
<meta property="og:url" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/">
<meta property="og:site_name" content="bugstop">
<meta property="og:description" content="Deep Learning Specialization, Course ESequence Models by deeplearning.ai, Andrew Ng, Coursera Week 1: Recurrent Neural Networks  Learn about recurrent neural networks. This type of model has been prov">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/1.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/2.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/3.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/4.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/5.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/6.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/7.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/8.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/9.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/10.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/11.png">
<meta property="og:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/12.png">
<meta property="article:published_time" content="2020-04-11T09:15:42.000Z">
<meta property="article:modified_time" content="2021-01-29T02:22:08.545Z">
<meta property="article:author" content="Muhan Li">
<meta property="article:tag" content="Artificial Intelligence">
<meta property="article:tag" content="Deep Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/1.png">

<link rel="canonical" href="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Deep Learning (14) · Recurrent Neural Networks | bugstop</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">bugstop</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Tech Blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="far fa-window-maximize fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fas fa-quote-left fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fas fa-hashtag fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fas fa-bars fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fas fa-inbox fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    

  <a href="https://github.com/bugstop" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://muhan.li/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/lightball.png">
      <meta itemprop="name" content="Muhan Li">
      <meta itemprop="description" content="bugstop">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="bugstop">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Deep Learning (14) · Recurrent Neural Networks
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 04-11-2020 17:15:42" itemprop="dateCreated datePublished" datetime="2020-04-11T17:15:42+08:00">04-11-2020</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Open-Course/" itemprop="url" rel="index"><span itemprop="name">Open Course</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Open-Course/Deep-Learning/" itemprop="url" rel="index"><span itemprop="name">Deep Learning</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Symbols count in article">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
              <span>6.4k</span>
            </span>
            <span class="post-meta-item" title="Reading time">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
              <span>6 mins.</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>Deep Learning Specialization, Course E<br><strong>Sequence Models</strong> by deeplearning.ai, <strong><em>Andrew Ng,</em></strong> <a target="_blank" rel="noopener" href="https://www.coursera.org/learn/neural-networks-deep-learning/home/info">Coursera</a></p>
<p><strong><em>Week 1:</em></strong> <em>Recurrent Neural Networks</em></p>
<ol>
<li>Learn about recurrent neural networks. This type of model has been proven to perform extremely well on temporal data. It has several variants including LSTMs, GRUs and Bidirectional RNNs, which you are going to learn about in this section.</li>
</ol>
<a id="more"></a>
<h3 id="Recurrent-Neural-Networks"><a href="#Recurrent-Neural-Networks" class="headerlink" title="Recurrent Neural Networks"></a>Recurrent Neural Networks</h3><h4 id="Notation"><a href="#Notation" class="headerlink" title="Notation"></a>Notation</h4><ul>
<li><strong><em>x:</em></strong> x<sup>&lt;1&gt;</sup>, x<sup>&lt;2&gt;</sup>, x<sup>&lt;3&gt;</sup>, …, x<sup>&lt;t&gt;</sup>, …, x<sup>&lt;9&gt;</sup>,   T<sub>x</sub> = 9<br><em>Harry Potter and Hermione Granger invented a new spell.</em></li>
<li><strong><em>y:</em></strong> y<sup>&lt;1&gt;</sup>, y<sup>&lt;2&gt;</sup>, y<sup>&lt;3&gt;</sup>, …, y<sup>&lt;t&gt;</sup>, …, y<sup>&lt;9&gt;</sup>,   T<sub>y</sub> = 9<br>named-entity recognition: <em>1 1 0 1 1 0 0 0 0</em></li>
</ul>
<p>$\begin{matrix} \qquad \textit{x:} &amp; \textsf{Harry} &amp; \textsf{Potter} &amp; \textsf{and} &amp; \textsf{Hermione} &amp; \textsf{Granger} &amp; \textsf{invented} &amp; \textsf{a} &amp; \textsf{new} &amp; \textsf{spell} \\ &amp; x^{\left\lt 1\right\gt } &amp; x^{\left\lt 2\right\gt } &amp; x^{\left\lt 3\right\gt } &amp; x^{\left\lt 4\right\gt } &amp; x^{\left\lt 5\right\gt } &amp; x^{\left\lt 6\right\gt } &amp; x^{\left\lt 7\right\gt } &amp; x^{\left\lt 8\right\gt } &amp; x^{\left\lt 9\right\gt } \\ {\rm Vocabulary} &amp; \downarrow &amp; \downarrow &amp; \downarrow &amp; \large{\rm one \ hot}  &amp;&amp;&amp;&amp;&amp; \\ \left[\begin{matrix} \rm a \\ \rm aaron \\ \vdots \\ \rm and \\ \vdots \\ \rm harry \\ \vdots \\ \rm potter \\ \vdots \\ \rm zulu \end{matrix}\right] &amp; \left[\begin{matrix} 0 \\ 0 \\ \vdots \\ 0 \\ \vdots \\ 1 \\ \vdots \\ 0 \\ \vdots \\ 0 \end{matrix}\right] &amp; \left[\begin{matrix} 0 \\ 0 \\ \vdots \\ 0 \\ \vdots \\ 0 \\ \vdots \\ 1 \\ \vdots \\ 0 \end{matrix}\right] &amp; \left[\begin{matrix} 0 \\ 0 \\ \vdots \\ 1 \\ \vdots \\ 0 \\ \vdots \\ 0 \\ \vdots \\ 0 \end{matrix}\right] &amp; \cdots &amp; \cdots \end{matrix}$</p>
<p>use a new fake word <strong>&lt;UNK&gt;</strong> to represent words not in the vocabulary<br>use a toke <strong>&lt;EOS&gt;</strong> to represent the end of every sentence</p>
<h4 id="Recurrent-Neural-Network-Model"><a href="#Recurrent-Neural-Network-Model" class="headerlink" title="Recurrent Neural Network Model"></a>Recurrent Neural Network Model</h4><p><strong>Why not a standard network</strong></p>
<ul>
<li>inputs and outputs can be different lengths in different examples</li>
<li>does not share features learned across different positions of text</li>
</ul>
<p><strong>Recurrent Neural Network</strong></p>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/1.png" alt></p>
<p><strong><em>limitation:</em></strong> not using information later in the sequence → BRNN (Bidirectional Recurrent Neural Network)</p>
<h5 id="Forward-Propagation"><a href="#Forward-Propagation" class="headerlink" title="Forward Propagation"></a>Forward Propagation</h5><p>$\begin{aligned}a^{\left\lt 0\right\gt } &amp;= \overrightarrow {0} _{\strut} \\ a^{\left\lt 1\right\gt } &amp;= g\left( W_{aa} a^{\left\lt 0\right\gt } + W_{ax} x^{\left\lt 1\right\gt } +b_a \right) &amp;{\rm tanh / ReLU} \\ \hat{y}^{\left\lt 1\right\gt } &amp;= g\left( W_{ya} a^{\left\lt 1\right\gt } +b_y \right) &amp;{\rm sigmoid / softmax} \\ &amp;\ \ \vdots \\ a^{\left\lt t\right\gt } &amp;= g\left( W_{aa} a^{\left\lt t-1\right\gt } + W_{ax} x^{\left\lt t\right\gt } +b_a \right) \\ &amp;= g\left( W_{a} \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_a \right) &amp; W_a &amp;= \left[ \begin{array}{c|c} W_{aa} &amp; W_{ax} \end{array} \right] \\ \hat{y}^{\left\lt t\right\gt } &amp;= g\left( W_{ya} a^{\left\lt t\right\gt } +b_y \right) = g\left( W_{y} a^{\left\lt t\right\gt } +b_y \right) &amp; \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] &amp;= \left[ \begin{array}{c} a^{\left\lt t-1\right\gt } \\ \hline x^{\left\lt t\right\gt } \end{array} \right] \end{aligned}$</p>
<h4 id="Backpropagation-Through-Time"><a href="#Backpropagation-Through-Time" class="headerlink" title="Backpropagation Through Time"></a>Backpropagation Through Time</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/2.png" alt></p>
<p>$\begin{aligned} &amp; L^{\left\lt t\right\gt } \left( \hat{y}^{\left\lt t\right\gt }, y^{\left\lt t\right\gt } \right) = -{y}^{\left\lt t\right\gt } \log \hat{y}^{\left\lt t\right\gt } - \left(1-{y}^{\left\lt t\right\gt } \right) \log \left( 1- \hat{y}^{\left\lt t\right\gt } \right) \\ &amp; L \left( \hat{y}, y\right) = \sum_{t=1}^{T_y} L^{\left\lt t\right\gt } \left( \hat{y}^{\left\lt t\right\gt }, y^{\left\lt t\right\gt } \right)  \end{aligned}$</p>
<h4 id="Different-Types-of-RNNs"><a href="#Different-Types-of-RNNs" class="headerlink" title="Different Types of RNNs"></a>Different Types of RNNs</h4><ul>
<li>many-to-many architecture</li>
<li>many-to-one architecture</li>
<li>one-to-many architecture</li>
<li>one-to-one architecture</li>
<li>many-to-many architecture <em>(different length)</em></li>
</ul>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/3.png" alt></p>
<h4 id="Language-Model-and-Sequence-Generation"><a href="#Language-Model-and-Sequence-Generation" class="headerlink" title="Language Model and Sequence Generation"></a>Language Model and Sequence Generation</h4><p>$P\left( y^{\left\lt 1\right\gt }, y^{\left\lt 2\right\gt }, \dots, y^{\left\lt T_y\right\gt }\right)$</p>
<ul>
<li><strong><em>training set:</em></strong> large corpus of text</li>
</ul>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/4.png" alt></p>
<p>$\begin{aligned} &amp; L^{\left\lt t\right\gt } \left( \hat{y}^{\left\lt t\right\gt }, y^{\left\lt t\right\gt } \right) = - \sum_i {y}^{\left\lt t\right\gt }_i \log \hat{y}^{\left\lt t\right\gt } _i \\ &amp; L \left( \hat{y}, y\right) = \sum_t L^{\left\lt t\right\gt } \left( \hat{y}^{\left\lt t\right\gt }, y^{\left\lt t\right\gt } \right)  \end{aligned}$</p>
<h4 id="Sampling-Novel-Sequences"><a href="#Sampling-Novel-Sequences" class="headerlink" title="Sampling Novel Sequences"></a>Sampling Novel Sequences</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/5.png" alt></p>
<h4 id="Vanishing-Gradients-with-RNNs"><a href="#Vanishing-Gradients-with-RNNs" class="headerlink" title="Vanishing Gradients with RNNs"></a>Vanishing Gradients with RNNs</h4><p>$\xleftarrow{\textrm{The}\ cat\ \textrm{which … …} \ was\ \textrm{full.}}$<br>$\xleftarrow{\textrm{The}\ cats\ \textrm{which … …} \ were\ \textrm{full.}}$</p>
<h4 id="Gated-Recurrent-Unit-GRU"><a href="#Gated-Recurrent-Unit-GRU" class="headerlink" title="Gated Recurrent Unit (GRU)"></a>Gated Recurrent Unit (GRU)</h4><p>$a ^{\left\lt t\right\gt } = \tanh \left( W_{a} \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_a \right)$</p>
<h5 id="Simplified-GRU"><a href="#Simplified-GRU" class="headerlink" title="Simplified GRU"></a>Simplified GRU</h5><ul>
<li><strong><em>c:</em></strong> memory cell, c<sup>&lt;t&gt;</sup> = a<sup>&lt;t&gt;</sup></li>
</ul>
<p>$\begin{aligned} \tilde{c} ^{\left\lt t\right\gt } &amp;= \tanh \left( W_{c} \left[ c^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_c \right) \\ \Gamma_u &amp;= {\rm sigmoid} \left( W_u \left[ c^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_u \right) &amp; {\approx 0 \ {\rm or} \ 1} \quad \textsf{Gate: update?} \\ c^{\left\lt t\right\gt } &amp;= \Gamma_u \odot \tilde{c}^{\left\lt t\right\gt }  + \left(1-\Gamma_u\right) \odot c^{\left\lt t-1\right\gt } \qquad &amp; \textsf{element-wise multiplication} \end{aligned}$</p>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/6.png" alt></p>
<h5 id="Full-GRU"><a href="#Full-GRU" class="headerlink" title="Full GRU"></a>Full GRU</h5><p>$\begin{aligned} \tilde{c} ^{\left\lt t\right\gt } &amp;= \tanh \left( W_{c} \left[ \Gamma_r \odot c^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_c \right) \\ \Gamma_u &amp;= {\rm sigmoid} \left( W_u \left[ c^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_u \right) \\ \Gamma_r &amp;= {\rm sigmoid} \left( W_r \left[ c^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_r \right) \\ c^{\left\lt t\right\gt } &amp;= \Gamma_u \odot \tilde{c}^{\left\lt t\right\gt } + \left(1-\Gamma_u\right) \odot c^{\left\lt t-1\right\gt } \\ {a} ^{\left\lt t\right\gt } &amp;= {c} ^{\left\lt t\right\gt } \end{aligned}$</p>
<h4 id="Long-Short-Term-Memory-LSTM"><a href="#Long-Short-Term-Memory-LSTM" class="headerlink" title="Long Short Term Memory (LSTM)"></a>Long Short Term Memory (LSTM)</h4><p>$\begin{aligned} \tilde{c} ^{\left\lt t\right\gt } &amp;= \tanh \left( W_{c} \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_c \right) \\ \Gamma_u &amp;= {\rm sigmoid} \left( W_u \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_u \right) &amp; \textsf{update gate} \\ \Gamma_f &amp;= {\rm sigmoid} \left( W_f \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_f \right) &amp; \textsf{forget gate} \\ \Gamma_o &amp;= {\rm sigmoid} \left( W_o \left[ a^{\left\lt t-1\right\gt }, x^{\left\lt t\right\gt } \right] +b_o \right) &amp; \textsf{output gate} \\ c^{\left\lt t\right\gt } &amp;= \Gamma_u \odot \tilde{c}^{\left\lt t\right\gt } + \Gamma_f \odot c^{\left\lt t-1\right\gt } \\ {a} ^{\left\lt t\right\gt } &amp;= \Gamma_o \odot \tanh \left( {c} ^{\left\lt t\right\gt } \right) \end{aligned}$</p>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/7.png" alt></p>
<h4 id="Bidirectional-RNN-BRNN"><a href="#Bidirectional-RNN-BRNN" class="headerlink" title="Bidirectional RNN (BRNN)"></a>Bidirectional RNN (BRNN)</h4><p><strong>Acyclic Graph</strong></p>
<p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/8.png" alt></p>
<p>$\hat{y}^{\left\lt t\right\gt } = g\left( W_y \left[ \overrightarrow {a}^{\left\lt t\right\gt } , \overleftarrow {a}^{\left\lt t\right\gt } \right] +b_y\right)$</p>
<h4 id="Deep-RNNs"><a href="#Deep-RNNs" class="headerlink" title="Deep RNNs"></a>Deep RNNs</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/9.png" alt></p>
<h3 id="Programming-Assignments"><a href="#Programming-Assignments" class="headerlink" title="Programming Assignments"></a>Programming Assignments</h3><h4 id="Building-a-Recurrent-Neural-Network-step-by-step"><a href="#Building-a-Recurrent-Neural-Network-step-by-step" class="headerlink" title="Building a Recurrent Neural Network - step by step"></a>Building a Recurrent Neural Network - step by step</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/10.png" alt></p>
<h4 id="Dinosaur-Island-Character-Level-Language-Modeling"><a href="#Dinosaur-Island-Character-Level-Language-Modeling" class="headerlink" title="Dinosaur Island - Character-Level Language Modeling"></a>Dinosaur Island - Character-Level Language Modeling</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/11.png" alt></p>
<h4 id="Jazz-Improvisation-with-LSTM"><a href="#Jazz-Improvisation-with-LSTM" class="headerlink" title="Jazz Improvisation with LSTM"></a>Jazz Improvisation with LSTM</h4><p><img src="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-14/12.png" alt></p>
<p><a href="https://github.com/bugstop/coursera-deep-learning-solutions" target="_blank">Solutions Manual</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Artificial-Intelligence/" rel="tag"># Artificial Intelligence</a>
              <a href="/tags/Deep-Learning/" rel="tag"># Deep Learning</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-13/" rel="prev" title="Deep Learning (13) · Special Applications">
      <i class="fa fa-chevron-left"></i> Deep Learning (13) · Special Applications
    </a></div>
      <div class="post-nav-item">
    <a href="/post/Open-Course/Deep-Learning/Deep-Learning-Andrew-Ng-15/" rel="next" title="Deep Learning (15) · Natural Language Processing">
      Deep Learning (15) · Natural Language Processing <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Recurrent-Neural-Networks"><span class="nav-number">1.</span> <span class="nav-text">Recurrent Neural Networks</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Notation"><span class="nav-number">1.1.</span> <span class="nav-text">Notation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Recurrent-Neural-Network-Model"><span class="nav-number">1.2.</span> <span class="nav-text">Recurrent Neural Network Model</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Forward-Propagation"><span class="nav-number">1.2.1.</span> <span class="nav-text">Forward Propagation</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Backpropagation-Through-Time"><span class="nav-number">1.3.</span> <span class="nav-text">Backpropagation Through Time</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Different-Types-of-RNNs"><span class="nav-number">1.4.</span> <span class="nav-text">Different Types of RNNs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Language-Model-and-Sequence-Generation"><span class="nav-number">1.5.</span> <span class="nav-text">Language Model and Sequence Generation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Sampling-Novel-Sequences"><span class="nav-number">1.6.</span> <span class="nav-text">Sampling Novel Sequences</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Vanishing-Gradients-with-RNNs"><span class="nav-number">1.7.</span> <span class="nav-text">Vanishing Gradients with RNNs</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gated-Recurrent-Unit-GRU"><span class="nav-number">1.8.</span> <span class="nav-text">Gated Recurrent Unit (GRU)</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Simplified-GRU"><span class="nav-number">1.8.1.</span> <span class="nav-text">Simplified GRU</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Full-GRU"><span class="nav-number">1.8.2.</span> <span class="nav-text">Full GRU</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Long-Short-Term-Memory-LSTM"><span class="nav-number">1.9.</span> <span class="nav-text">Long Short Term Memory (LSTM)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bidirectional-RNN-BRNN"><span class="nav-number">1.10.</span> <span class="nav-text">Bidirectional RNN (BRNN)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Deep-RNNs"><span class="nav-number">1.11.</span> <span class="nav-text">Deep RNNs</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Programming-Assignments"><span class="nav-number">2.</span> <span class="nav-text">Programming Assignments</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Building-a-Recurrent-Neural-Network-step-by-step"><span class="nav-number">2.1.</span> <span class="nav-text">Building a Recurrent Neural Network - step by step</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dinosaur-Island-Character-Level-Language-Modeling"><span class="nav-number">2.2.</span> <span class="nav-text">Dinosaur Island - Character-Level Language Modeling</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Jazz-Improvisation-with-LSTM"><span class="nav-number">2.3.</span> <span class="nav-text">Jazz Improvisation with LSTM</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Muhan Li"
      src="/images/lightball.png">
  <p class="site-author-name" itemprop="name">Muhan Li</p>
  <div class="site-description" itemprop="description">bugstop</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">35</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/bugstop" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;bugstop" rel="noopener" target="_blank"><i class="fab fa-github-square fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.linkedin.com/public-profile/in/limh" title="LinkedIn → https:&#x2F;&#x2F;www.linkedin.com&#x2F;public-profile&#x2F;in&#x2F;limh" rel="noopener" target="_blank"><i class="fab fa-linkedin fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:limuhan@msn.com" title="Email → mailto:limuhan@msn.com" rel="noopener" target="_blank"><i class="fas fa-envelope-square fa-fw"></i></a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Li, Muhan</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="Symbols count total">141k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="Reading time total">2:09</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

</body>
</html>
